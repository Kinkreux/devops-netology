Домашнее задание к занятию "5.1. Основы виртуализации"

**Задача 1
Вкратце опишите, как вы поняли - в чем основное отличие паравиртуализации и виртуализации на основе ОС.**

При паравиртуализации есть гипервизор. Это в принципе аппаратная виртуализация с гипервизором, просто с дополнительной плюшкой: часть системных вызовов прокидывается мимо гипервизора напрямую ради увеличения скорости отклика. БОльшая часть устройств эмулирована внутри каждой виртуальной машины отдельно, там есть свое ядро, все свое. Каждую виртуальную машину надо настраивать и админить.

А виртуализация на основе ОС означает, что гипервизора нет, его роль выполняет демон, поставляемый вместе с ОС. Такой есть, например, во многих поставках линукс-подобных систем. Докер строится на базе средств виртуализации самой ОС, к примеру, он просто надстройка над средствами ОС. Я не уверена на 100%, но могу предположить, что, хотя специальные средства виртуализации ОС управляют контейнерами и их iops изолированы (я верно употребляю этот термин?), на самом деле каждый контейнер пользуется одинаковыми устройствами, эмулированными на уровне ОС. Кроме того, контейнеры ограничены той ОС, на которой поднимаются, потому что не имеют своего ядра и прочих настроек. Их не нужно админить.

**Задача 2
Выберите тип один из вариантов использования организации физических серверов, в зависимости от условий использования.**

Организация серверов:

- физические сервера
- паравиртуализация
- виртуализация уровня ОС

Условия использования:

1. **Высоконагруженная база данных, чувствительная к отказу** - физический сервер, потому что для базы данных крайне важна скорость чтения и записи, а любая виртуализация их режет.
2. **Различные Java-приложения** - я бы использовала виртуализацию уровня ОС, тот же Докер. Это позволит уменьшить размер хранимых образов и программ, в т.ч. версий Java и сопутствующего софта, упростит тестирование и масштабирование. При условии, что всекрутится на осной ОС.
3. **Windows системы для использования Бухгалтерским отделом** - я бы использовала Hyper-V, по-моему, это паравиртуализация на основе Винды, будет отличная совместимость и скорость, близкая к физическому серверу.
4. **Системы, выполняющие высокопроизводительные расчеты на GPU** - наверно, я бы использовала паравиртуализацию, потому что это позволяет распределить вычисления по разным машинам, но не сильно потерять в скорости iops.

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

**Задача 3
Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.**

Сценарии:


**1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований** - Я бы предложила KVM. Заранее известно, что нужны машины и под винду, а у KVM с ней получше. Минус KVM - проблемы с input-output, но если особых задач нет, он не очень важен. Кстати, можно и облако.

**2. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий** - У меня нет сисадминского бэкграунда, поэтому я ничего не могу сказать про балансировщик, репликации и проч. Единственное, что приходит в голову, что это означает высоконагруженность, раз вообще нужны балансировщики и им надо где-то работать, раз вообще нужна репликация. Наверно, это скорее продакшн-система, если нужен механизм создания резервных копий. Я бы предложила VMVare Sphere, если есть деньги на железо и поддержку. Если нет, то KVM может не справиться, Xen винду поддерживает похуже, а Hyper-V не подходит, потому что машины будут не только виндовые. Даже не знаю, что, если не "Сфера".

**3. Требуется наиболее производительное бесплатное opensource решение для виртуализации небольшой (20 серверов) инфраструктуры Linux и Windows виртуальных машин** Гм, опять KVM?) Бесплатное - да, совместимое и производительное - да (среди бесплатных), опять же Xen похуже работает с Виндой. Можно облако.

**4. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры** Опять KVM ?? Бесплатное - да, совместимое и производительное - да.

**5. Необходимо рабочее окружение для тестирование программного продукта на нескольких дистрибутивах Linux** Предлагаю Контейнеры : )) Лучше всего подойдут. Либо Xen. Я правильно понимаю, что мы можем поднять ядро любое, а потом все равно машинками запустить разные дистрибутивы? Xen хорошо поддерживает Линукс-подобные системы.

**Задача 4
Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был бы выбор, то создавали ли вы бы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.**

Если бы у меня был выбор, я бы использовала для каждого стека свою виртуализацию на разных машинах: для винды Hyper-V, для линуксов Xen или контейнеры. У меня почему-то сложилось впечатление, что паравиртуализация или аппаратная - это самые лучшие варианты, если стек совпадает. Винда для винды и Линкус для Линукса. И не так дорого, как VMVare Sphere.

Наверно, мне не хватает реального опыта работы, чтобы понять, какие именно причины вызывают использование разных стеков одновременно. Я понимаю, что компания может использовать MS AD и какой-нибудь Аутлук, и одновременно крутить свою CRM на Линкус-сервере, к примеру. Но с большими организациями, где бы реально работал devops и имелись высоконагруженные системы в разных стеках, я в реальной работе не сталкивалась.

Гетерогенная виртуализация может, наверно, вызвать такие проблемы. 1) конфликты при выделении ресурсов, ведь каждая виртуализация наверно хочет рулить всем железом? Особенно при аппаратной виртуализации, которую вообще непонятно, как совмещать в рамках одной железной машины. 2) конфликты драйверов, наверно? 3) крайне неравномерную работу, вряд ли можно в таких условиях гарантировать отказоустойчивость и стабильную произвоизводительность. 4) интересно, что с безопасностью? Во-первых, как уживутся системы защиты обеих виртуализаций, а во-вторых, как их изолировать? Мы в этом случае теряем базовое преимущество виртуализации - полную изоляцию.

Как избежать этих проблем, я не знаю. Мне не хватает знаний и опыта, даже чтобы понять, что я нашла реальные проблемы. И туда ли я воюю. То же самое с примерами. : (